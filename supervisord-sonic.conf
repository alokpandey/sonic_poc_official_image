[supervisord]
nodaemon=true
user=root
logfile=/opt/sonic/var/log/supervisord.log
pidfile=/var/run/supervisord.pid
childlogdir=/opt/sonic/var/log

[unix_http_server]
file=/var/run/supervisor.sock
chmod=0700

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///var/run/supervisor.sock

# Redis Database
[program:redis]
command=redis-server --bind 127.0.0.1 --port 6379 --dir /opt/sonic/var/run
user=sonic
autostart=true
autorestart=true
stderr_logfile=/opt/sonic/var/log/redis.err.log
stdout_logfile=/opt/sonic/var/log/redis.out.log
priority=100

# SONiC Main Application (C++)
[program:sonic-main]
command=/opt/sonic/bin/sonic_poc
directory=/opt/sonic
user=sonic
autostart=true
autorestart=true
stderr_logfile=/opt/sonic/var/log/sonic-main.err.log
stdout_logfile=/opt/sonic/var/log/sonic-main.out.log
environment=SONIC_CONFIG_DIR="/opt/sonic/etc",SONIC_LOG_DIR="/opt/sonic/var/log"
priority=200
depends_on=redis

# SAI Command Processor (C++)
[program:sai-command-processor]
command=/opt/sonic/bin/sai_command_processor
directory=/opt/sonic
user=sonic
autostart=true
autorestart=true
stderr_logfile=/opt/sonic/var/log/sai-command-processor.err.log
stdout_logfile=/opt/sonic/var/log/sai-command-processor.out.log
environment=SONIC_CONFIG_DIR="/opt/sonic/etc",SONIC_LOG_DIR="/opt/sonic/var/log"
priority=210
depends_on=redis

# BSP Health Monitor API (Python)
[program:bsp-api]
command=python3 /opt/sonic/python/bsp_api.py
directory=/opt/sonic
user=sonic
autostart=true
autorestart=true
stderr_logfile=/opt/sonic/var/log/bsp-api.err.log
stdout_logfile=/opt/sonic/var/log/bsp-api.out.log
environment=PYTHONPATH="/opt/sonic/python",SONIC_CONFIG_DIR="/opt/sonic/etc"
priority=300
depends_on=sonic-main

# SAI Management API (Python)
[program:sai-api]
command=python3 /opt/sonic/python/sai_api.py
directory=/opt/sonic
user=sonic
autostart=true
autorestart=true
stderr_logfile=/opt/sonic/var/log/sai-api.err.log
stdout_logfile=/opt/sonic/var/log/sai-api.out.log
environment=PYTHONPATH="/opt/sonic/python",SONIC_CONFIG_DIR="/opt/sonic/etc"
priority=300
depends_on=sai-command-processor

# Test Runner (Python)
[program:test-runner]
command=python3 /opt/sonic/python/test_runner.py
directory=/opt/sonic
user=sonic
autostart=false
autorestart=false
stderr_logfile=/opt/sonic/var/log/test-runner.err.log
stdout_logfile=/opt/sonic/var/log/test-runner.out.log
environment=PYTHONPATH="/opt/sonic/python",SONIC_CONFIG_DIR="/opt/sonic/etc"
priority=400

# Prometheus Metrics Exporter
[program:metrics-exporter]
command=python3 /opt/sonic/python/metrics_exporter.py
directory=/opt/sonic
user=sonic
autostart=true
autorestart=true
stderr_logfile=/opt/sonic/var/log/metrics-exporter.err.log
stdout_logfile=/opt/sonic/var/log/metrics-exporter.out.log
environment=PYTHONPATH="/opt/sonic/python"
priority=300
depends_on=sonic-main
